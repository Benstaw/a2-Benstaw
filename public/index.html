<!doctype html>
<html lang="en">
  <head>
    <title>CS4241 Assignment 2</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="css/style.css">
    <div class='schedule'></div>
  </head>
  <body>
    <form method="post">
    <ul>
      <li>
        <label for="todo">Todo:</label>
        <textarea id="todo" name="todo"></textarea>
      </li>
      <li>
        <label for="day">Select Day of the Week</label>
          <select id="day" name="day">
            <option value="Sunday">Sunday</option>
            <option value="Monday">Monday</option>
            <option value="Tuesday">Tuesday</option>
            <option value="Wednesday">Wednesday</option>
            <option value="Thursday">Thursday</option>
            <option value="Friday">Friday</option>
            <option value="Saturday">Saturday</option>
        </select>
      </li>
      <li>
        <label for="priority">Select priority</label>
          <select id="priority" name="priority">
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
        </select>
      </li>
      <li class="button">
        <button type="button">SUBMIT</button>
      </li>     
    </ul>
    </form>
    <h1>Your Todos:</h1>
    <table style="table-layout: auto;" id="dataTable"></table>
    <h1>Weekly Difficulty Tracker</h1>
    <table style="table-layout: auto;" id="dificulty"></table>
  </body>

  <script>

  const submit = function( e ) {
    // prevent default form action from being carried out
    e.preventDefault()

    const todoInput = document.querySelector( '#todo' )
    const dayInput = document.querySelector( '#day' )
    const priority = document.querySelector('#priority')
   // const difficulty = document.querySelector('#difficulty')
    
          json = { todo: todoInput.value, 
                    day: dayInput.value, 
                    priority: priority.value, 
                    }
          body = JSON.stringify( json )



    fetch( '/submit', {
      method:'POST',
      body 
    })
    .then( function( response ) {
        return response.json()
    })
    .then(function(json){
        console.log(json)
        document.getElementById('dataTable').remove()
        createTable(json)
    });

    return false
  }
  
  window.onload = function() {
    const button = document.querySelector( 'button' )
    button.onclick = submit
  }

 function createTable(data) {
    let table = document.createElement('table')
    let tr = document.createElement('tr')
    let tableHeaders = ['Day of the Week', 'Items/Priorities...']

    for (let count = 0; count < tableHeaders.length; count++) {
      let header = document.createTextNode(tableHeaders[count])
      let th = document.createElement('th')
      th.appendChild(header)
      tr.appendChild(th)
    }
    table.appendChild(tr)
    tr = document.createElement('tr');

    function populateDay(day){
      let dayOfWeek = document.createTextNode(day)
      let td = document.createElement('td')

      td.appendChild(dayOfWeek)
      tr.appendChild(td)

      for (let count = 0; count < data.length; count++){
        if(data[count].day === day){
          let item = document.createTextNode(data[count].todo)
          let td = document.createElement('td')
          td.appendChild(item)
          tr.appendChild(td)

          item = document.createTextNode(data[count].priority)
          td = document.createElement('td')
          td.appendChild(item)
          tr.appendChild(td)

          item = document.createTextNode(' ')
          td = document.createElement('td')
          td.appendChild(item)
          tr.appendChild(td)

          item = document.createTextNode(data[count].difficulty)
          td = document.createElement('td')
          td.appendChild(item)
          tr.appendChild(td)

          item = document.createTextNode(' ')
          td = document.createElement('td')
          td.appendChild(item)
          tr.appendChild(td)
        }
    }
    table.appendChild(tr);
    tr = document.createElement('tr');

  }
    table.id = 'dataTable'

  populateDay("Sunday")
  populateDay("Monday")
  populateDay("Tuesday")
  populateDay("Wednesday")
  populateDay("Thursday")
  populateDay("Friday")
  populateDay("Saturday")

  document.body.appendChild(table)

}

  </script>
</html>